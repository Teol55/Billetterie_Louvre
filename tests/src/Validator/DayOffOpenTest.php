<?php
/**
 * Created by PhpStorm.
 * User: tof
 * Date: 15/02/2019
 * Time: 08:57
 */

namespace App\Tests\src\Validator;




use App\Validator\DayOffOpen;
use App\Validator\DayOffOpenValidator;
use Symfony\Component\Validator\ConstraintValidator;
use Symfony\Component\Validator\Test\ConstraintValidatorTestCase;


class DayOffOpenTest extends ConstraintValidatorTestCase
{


    protected function createValidator()
    {


        return new DayOffOpenValidator();

    }


    /**
     * @dataProvider dateVisitValide
     */
    public function testNotDayOff($date)
    {

        $this->validator->validate(new \DateTime($date),new DayOffOpen());
        $this->assertNoViolation();

    }
    /**
     * @dataProvider dateVisitOff
     */
    public function testDayOff($date)
    {


        $constraint= new DayOffOpen([
            'message'=> 'myMessage'
        ]);

        $this->validator->validate(new \DateTime($date),$constraint);

        $this->buildViolation($constraint->message)
            ->setParameter('{{ date }}', date_format(new \DateTime($date),'d-m-Y'))
            ->assertRaised();
    }

    public function dateVisitOff()
    {
        return[['2020-01-01'],
            ['2019-05-08'],
            ['2019-07-14'],
            ['2019-08-15'],
            ['2020-11-11'],
            ['2019-11-11'],

        ];
    }
    public function dateVisitValide()
    {
        return[['2020-01-03'],
        ['2019-05-07'],
            ['2019-07-13'],
            ['2019-08-14'],
            ['2020-11-01'],
            ['2019-11-12']

        ];
    }
}